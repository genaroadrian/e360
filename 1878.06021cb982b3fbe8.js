"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[1878],{1878:(dt,x,s)=>{s.r(x),s.d(x,{CheckoutModule:()=>ct});var p=s(6814),d=s(2507),t=s(4769),_=s(2198);let U=(()=>{class e{constructor(){this.isLogged=!1,this.items=[{label:"Elegir Direcci\xf3n",routerLink:"choose-address"},{label:"Env\xedo y Pago",routerLink:"payment"},{label:"Confirmar Pedido",routerLink:"confirm-order"}]}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-checkout"]],decls:6,vars:2,consts:[[1,"container","mx-auto"],[1,"steps-container","py-4","mb-4"],[1,"text-center","mt-5","text-4xl"],[3,"model","readonly"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"Confirma tu Compra"),t.qZA(),t._UZ(4,"p-steps",3),t.qZA(),t._UZ(5,"router-outlet"),t.qZA()),2&o&&(t.xp6(4),t.Q6J("model",r.items)("readonly",!0))},dependencies:[d.lC,_.R],styles:[".steps-container[_ngcontent-%COMP%]     .p-steps-item .p-menuitem-link{background-color:transparent!important}"]})}return e})();var q=s(9773),g=s(9397),h=s(5129),m=s(4296),O=s(6369),k=s(5359),y=s(5219),A=s(707),f=s(3714),P=s(3965),T=s(9552),i=s(95);class S{constructor(){this.username=new i.NI(null,[i.kI.required]),this.password=new i.NI(null,[i.kI.required])}}var J=s(6306),E=s(8504),b=s(4716);const v={required:e=>"El campo es obligatorio",email:e=>"El campo debe ser un correo v\xe1lido",minlength:e=>`El campo debe tener m\xednimo ${e.requiredLength} caracteres`,maxlength:e=>`El campo debe tener m\xe1ximo ${e.requiredLength} caracteres`,min:e=>`El valor min\xedmo es ${e.min}`,max:e=>`El valor maximo es ${e.max}`,dateRange:e=>"La fecha m\xe1xima no puede ser menor a fecha de inicio",numeric:e=>"El campo debe ser n\xfamerico",nonExist:e=>"El registro no existe",passwordMismatch:e=>"Las contrase\xf1as no coinciden"};let N=(()=>{class e{invalidClass(n){return this.isInvalid(n)?"form-danger":"form-secondary"}isInvalid(n){return!(!n.invalid||!n.touched&&!n.dirty)}handleError(n){let o,r,a="El campo es inv\xe1lido";return n&&n.errors&&(o=Object.keys(n.errors)[0],r=Object.values(n.errors)[0],o&&Object.keys(v).forEach(l=>{l==o&&(a=v[o](r))})),a}setControlError(n,o,r){n&&n.setErrors({[o]:r||!0})}handleServerErrors(n,o){n.forEach(r=>{this.getFieldAndCode(r,o)})}getFieldAndCode(n,o){const r=n.split(".",3);if(2===r.length||3===r.length){const a=r[0],l=o.get([a]);l.controls&&r.length>=4?this.validateFormArray(r,o,l):this.validateForm(r,o,a)}}validateForm(n,o,r){const a=n[1];let u=null;("minlength"===a||"maxlength"===a)&&(u={requiredLength:n[2]}),o.markAllAsTouched(),o.get([r])&&this.setControlError(o.get(r),a,u)}validateFormArray(n,o,r){const a=Number(n[1]),l=n[2],u=n[3];let I=null;("minlength"===u||"maxlength"===u)&&(I={requiredLength:n[4]}),o.markAllAsTouched();const M=r.controls[a];M.get(l)&&this.setControlError(M.get(l),u,I)}minLengthArray(n){return o=>o.value.length>=n?null:{minLengthArray:{valid:!1}}}validateSpace(n){return o=>{if(o.value.includes(" "))return v.noSpace()}}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Q(e,c){1&e&&(t.TgZ(0,"span"),t._uU(1,"*"),t.qZA()),2&e&&t.Udp("color","#9D2449")}function R(e,c){if(1&e&&(t.TgZ(0,"small",3),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" ",n.getErrorMessage(),"")}}const j=["*"];let F=(()=>{class e{constructor(n){this.validationService=n}isInvalid(){return this.validationService.isInvalid(this.control)}invalidClass(){return this.validationService.invalidClass(this.control)}getErrorMessage(){return this.validationService.handleError(this.control)}isRequired(){return this.control.hasValidator(i.kI.required)}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(N))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["form-field"]],inputs:{control:"control",label:"label"},ngContentSelectors:j,decls:6,vars:3,consts:[[1,"field"],[3,"color",4,"ngIf"],["id","username-help","class","p-error",4,"ngIf"],["id","username-help",1,"p-error"]],template:function(o,r){1&o&&(t.F$t(),t.TgZ(0,"div",0)(1,"label"),t._uU(2),t.YNc(3,Q,2,2,"span",1),t.qZA(),t.Hsn(4),t.YNc(5,R,2,1,"small",2),t.qZA()),2&o&&(t.xp6(2),t.hij("",r.label," "),t.xp6(1),t.Q6J("ngIf",r.isRequired()),t.xp6(2),t.Q6J("ngIf",r.isInvalid()))},dependencies:[p.O5]})}return e})(),L=(()=>{class e{constructor(){this.label="",this.type="submit",this.loadingLabel="",this.loading=!1}static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["loading-button"]],inputs:{label:"label",type:"type",loadingLabel:"loadingLabel",loading:"loading"},decls:1,vars:3,consts:[[3,"type","label","loading"]],template:function(o,r){1&o&&t._UZ(0,"p-button",0),2&o&&t.Q6J("type",r.type)("label",r.loading?r.loadingLabel:r.label)("loading",r.loading)},dependencies:[A.zx],encapsulation:2})}return e})(),Y=(()=>{class e extends h.y{get controls(){return this.loginForm.controls}constructor(n,o){super(),this.fb=n,this.authService=o,this.successLogin=new t.vpe,this.loginForm=this.fb.group(new S)}onSignIn(){this.loginForm.valid?this.signIn().subscribe():this.invalidForm(this.loginForm)}signIn(){return this.loading=!0,this.authService.signIn(this.loginForm.getRawValue()).pipe((0,J.K)(n=>(0,E._)(()=>n)),(0,g.b)(()=>{this.successLogin.emit()}),(0,b.x)(()=>this.loading=!1))}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(i.qu),t.Y36(m.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-checkout-login"]],outputs:{successLogin:"successLogin"},features:[t._Bn([y.ez]),t.qOj],decls:8,vars:4,consts:[[1,"p-fluid",3,"formGroup","ngSubmit"],[1,"text-center","text-3xl"],["label","Correo Electr\xf3nico",3,"control"],["pInputText","","type","text","formControlName","username"],["label","Contrase\xf1a",3,"control"],["pInputText","","type","password","formControlName","password"],["label","Iniciar Sesi\xf3n","loadingLabel","Iniciando Sesi\xf3n",3,"loading"]],template:function(o,r){1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return r.onSignIn()}),t.TgZ(1,"h2",1),t._uU(2,"Ya soy cliente"),t.qZA(),t.TgZ(3,"form-field",2),t._UZ(4,"input",3),t.qZA(),t.TgZ(5,"form-field",4),t._UZ(6,"input",5),t.qZA(),t._UZ(7,"loading-button",6),t.qZA()),2&o&&(t.Q6J("formGroup",r.loginForm),t.xp6(3),t.Q6J("control",r.controls.username),t.xp6(2),t.Q6J("control",r.controls.password),t.xp6(2),t.Q6J("loading",r.loading))},dependencies:[f.o,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,F,L]})}return e})();class z{constructor(){this.username=new i.NI(null,[i.kI.required,i.kI.minLength(5),i.kI.maxLength(15)]),this.password=new i.NI(null,[i.kI.required,i.kI.minLength(8),i.kI.maxLength(20)]),this.confirmPassword=new i.NI(null,[i.kI.required,i.kI.minLength(8),i.kI.maxLength(20)]),this.email=new i.NI(null,[i.kI.required,i.kI.email]),this.direccion=new i.NI(null,[i.kI.required])}}function $(e){const c=e.get("password"),n=e.get("confirmPassword");return c.value!==n.value?(n.setErrors({passwordMismatch:!0}),null):(n.setErrors(null),null)}let D=(()=>{class e extends h.y{get controls(){return this.registerForm.controls}constructor(n,o){super(),this.fb=n,this.authService=o,this.successRegister=new t.vpe,this.registerForm=this.fb.group(new z)}ngOnInit(){this.registerForm.setValidators($)}onConfirmRegister(){this.registerForm.valid?this.register().subscribe():this.invalidForm(this.registerForm)}register(){return this.loading=!0,this.authService.signUp(this.registerForm.getRawValue()).pipe((0,g.b)(n=>{this.successRegister.emit()}),(0,b.x)(()=>this.loading=!1))}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(i.qu),t.Y36(m.e))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-checkout-register"]],outputs:{successRegister:"successRegister"},features:[t.qOj],decls:14,vars:7,consts:[[1,"p-fluid",3,"formGroup","ngSubmit"],[1,"text-center","text-3xl"],["label","Nombre de Usuario",3,"control"],["pInputText","","type","text","formControlName","username"],["label","Correo Electr\xf3nico",3,"control"],["pInputText","","type","text","formControlName","email"],["label","Contrase\xf1a",3,"control"],["pInputText","","type","password","formControlName","password"],["label","Confirmar Contrase\xf1a",3,"control"],["pInputText","","type","password","formControlName","confirmPassword"],["label","Direcci\xf3n",3,"control"],["pInputText","","type","text","formControlName","direccion"],["label","Crear Cuenta","loadingLabel","Creando Cuenta",3,"loading"]],template:function(o,r){1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return r.onConfirmRegister()}),t.TgZ(1,"h2",1),t._uU(2,"Soy Nuevo"),t.qZA(),t.TgZ(3,"form-field",2),t._UZ(4,"input",3),t.qZA(),t.TgZ(5,"form-field",4),t._UZ(6,"input",5),t.qZA(),t.TgZ(7,"form-field",6),t._UZ(8,"input",7),t.qZA(),t.TgZ(9,"form-field",8),t._UZ(10,"input",9),t.qZA(),t.TgZ(11,"form-field",10),t._UZ(12,"input",11),t.qZA(),t._UZ(13,"loading-button",12),t.qZA()),2&o&&(t.Q6J("formGroup",r.registerForm),t.xp6(3),t.Q6J("control",r.controls.username),t.xp6(2),t.Q6J("control",r.controls.email),t.xp6(2),t.Q6J("control",r.controls.password),t.xp6(2),t.Q6J("control",r.controls.confirmPassword),t.xp6(2),t.Q6J("control",r.controls.direccion),t.xp6(2),t.Q6J("loading",r.loading))},dependencies:[f.o,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,F,L]})}return e})();function X(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"app-checkout-login",4),t.NdJ("successLogin",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.switchLogin())}),t.qZA()(),t._UZ(4,"p-divider",5)(5,"p-divider",6),t.TgZ(6,"div",7)(7,"app-checkout-register",8),t.NdJ("successRegister",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.switchLogin())}),t.qZA()()()()}}function B(e,c){1&e&&(t.TgZ(0,"tr")(1,"th",26),t._uU(2," Carrito de Compras "),t.qZA()())}function H(e,c){if(1&e&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",27),t._uU(4),t.qZA(),t.TgZ(5,"td",27),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td",27),t._uU(9),t.ALo(10,"currency"),t.qZA()()),2&e){const n=c.$implicit;t.xp6(2),t.hij(" ",n.product.nombre," "),t.xp6(1),t.Q6J("width",60),t.xp6(1),t.hij(" ",n.quantity," "),t.xp6(1),t.Q6J("width",150),t.xp6(1),t.hij(" ",t.lcZ(7,7,n.product.precio)," "),t.xp6(2),t.Q6J("width",150),t.xp6(1),t.hij(" ",t.lcZ(10,9,n.product.precio*n.quantity)," ")}}function G(e,c){if(1&e&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2,"Total:"),t.qZA(),t.TgZ(3,"td",29),t._uU(4),t.ALo(5,"currency"),t.qZA()()),2&e){const n=t.oxw(2);t.xp6(4),t.hij(" ",t.lcZ(5,1,n.total)," ")}}const C=function(){return[]};function V(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",9)(2,"div",10)(3,"div",11)(4,"h2",12),t._uU(5,"Datos de Env\xedo"),t.qZA(),t.TgZ(6,"div",13)(7,"label"),t._uU(8,"Calle"),t.qZA(),t._UZ(9,"input",14),t.qZA(),t.TgZ(10,"div",15)(11,"label"),t._uU(12,"N\xfamero Ext."),t.qZA(),t._UZ(13,"input",16),t.qZA(),t.TgZ(14,"div",15)(15,"label"),t._uU(16,"N\xfamero Int."),t.qZA(),t._UZ(17,"input",16),t.qZA(),t.TgZ(18,"div",15)(19,"label",17),t._uU(20,"Pais"),t.qZA(),t._UZ(21,"p-dropdown",18),t.qZA(),t.TgZ(22,"div",15)(23,"label",17),t._uU(24,"Estado"),t.qZA(),t._UZ(25,"p-dropdown",18),t.qZA(),t.TgZ(26,"div",15)(27,"label",17),t._uU(28,"Ciudad"),t.qZA(),t._UZ(29,"p-dropdown",18),t.qZA(),t.TgZ(30,"div",15)(31,"label"),t._uU(32,"C\xf3digo Postal"),t.qZA(),t._UZ(33,"input",16),t.qZA(),t.TgZ(34,"div",19)(35,"div")(36,"p-button",20),t.NdJ("onClick",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.nextStep())}),t.qZA()()()()(),t._UZ(37,"p-divider",5)(38,"p-divider",6),t.TgZ(39,"div",21)(40,"p-table",22),t.ALo(41,"async"),t.YNc(42,B,3,0,"ng-template",23),t.YNc(43,H,11,11,"ng-template",24),t.YNc(44,G,6,3,"ng-template",25),t.qZA()()()()}if(2&e){const n=t.oxw();t.xp6(21),t.Q6J("options",t.DdM(6,C)),t.xp6(4),t.Q6J("options",t.DdM(7,C)),t.xp6(4),t.Q6J("options",t.DdM(8,C)),t.xp6(11),t.Q6J("value",t.lcZ(41,4,n.$cart))}}let K=(()=>{class e extends h.y{constructor(n,o){super(),this.authService=n,this.shoppingCartService=o,this.isLogged=!1,this.$cart=this.shoppingCartService.$items,this.total=0}ngOnInit(){this.shoppingCart().subscribe()}nextStep(){this.router.navigate(["../payment"],{relativeTo:this.activatedRoute})}shoppingCart(){return this.shoppingCartService.$items.pipe((0,q.R)(this.$unSubscribe),(0,g.b)(n=>{this.total=n.reduce((o,r)=>o+r.product.precio*r.quantity,0)}))}switchLogin(){console.log("llego"),this.isLogged=!0}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(m.e),t.Y36(O.F))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-choose-address"]],features:[t.qOj],decls:4,vars:6,consts:[["class","card _container",4,"ngIf"],[1,"card","_container"],[1,"grid"],[1,"login"],[3,"successLogin"],["layout","vertical",1,"vertical"],["layout","horizontal",1,"horizontal"],[1,"register"],[3,"successRegister"],[1,"grid","adress-resoume-container"],[1,"adress-container"],[1,"p-fluid","p-formgrid","grid"],[1,"text-center"],[1,"field","col-12","md:col-12"],["pInputText","","type","text"],[1,"field","col-12","md:col-6"],["pInputText","","type","number"],["htmlFor","state"],["optionLabel","name",3,"options"],[1,"field","col-12","flex","justify-content-end"],["label","Siguiente",1,"mt-2",3,"onClick"],[1,"cart-resume-container"],["styleClass","p-datatable-gridlines",3,"value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","footer"],["colspan","4",1,"text-center","text-xl"],[1,"text-right",3,"width"],["colspan","3",1,"text-right"],[1,"text-right"]],template:function(o,r){1&o&&(t.YNc(0,X,8,0,"div",0),t.ALo(1,"async"),t.YNc(2,V,45,9,"div",0),t.ALo(3,"async")),2&o&&(t.Q6J("ngIf",!t.lcZ(1,2,r.authService.payload).isLogged),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,r.authService.payload).isLogged))},dependencies:[p.O5,k.i,y.jx,A.zx,f.o,P.Lt,T.iA,Y,D,p.Ov,p.H9],styles:[".field[_ngcontent-%COMP%]{margin-bottom:0!important}.login[_ngcontent-%COMP%], .register[_ngcontent-%COMP%]{width:100%;padding:2rem 4rem}@media (min-width: 800px){.login[_ngcontent-%COMP%], .register[_ngcontent-%COMP%]{width:48%}}@media (max-width: 991px){.login[_ngcontent-%COMP%], .register[_ngcontent-%COMP%]{padding:2rem}}.vertical[_ngcontent-%COMP%]{width:4%}@media (max-width: 800px){.vertical[_ngcontent-%COMP%]{display:none}}.horizontal[_ngcontent-%COMP%]{display:none}@media (max-width: 800px){.horizontal[_ngcontent-%COMP%]{display:block;width:100%}}.adress-resoume-container[_ngcontent-%COMP%]   .adress-container[_ngcontent-%COMP%]{order:3;width:100%}@media (min-width: 950px){.adress-resoume-container[_ngcontent-%COMP%]   .adress-container[_ngcontent-%COMP%]{width:58%;order:1}}.adress-resoume-container[_ngcontent-%COMP%]   .adress-container[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{padding:2rem 4rem}.adress-resoume-container[_ngcontent-%COMP%]   .vertical[_ngcontent-%COMP%]{order:2}@media (max-width: 949px){.adress-resoume-container[_ngcontent-%COMP%]   .vertical[_ngcontent-%COMP%]{display:none}}.adress-resoume-container[_ngcontent-%COMP%]   .horizontal[_ngcontent-%COMP%]{order:2}@media (max-width: 949px){.adress-resoume-container[_ngcontent-%COMP%]   .horizontal[_ngcontent-%COMP%]{display:block;width:100%}}.adress-resoume-container[_ngcontent-%COMP%]   .cart-resume-container[_ngcontent-%COMP%]{order:1;padding:2rem;width:100%}@media (min-width: 950px){.adress-resoume-container[_ngcontent-%COMP%]   .cart-resume-container[_ngcontent-%COMP%]{order:3;width:38%;padding:2rem 1rem}}"]})}return e})();const W=function(){return["../choose-address"]},tt=function(){return["../confirm-order"]};let et=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-payment"]],decls:4,vars:4,consts:[[3,"routerLink"]],template:function(o,r){1&o&&(t.TgZ(0,"a",0),t._uU(1,"back"),t.qZA(),t.TgZ(2,"a",0),t._uU(3,"next"),t.qZA()),2&o&&(t.Q6J("routerLink",t.DdM(2,W)),t.xp6(2),t.Q6J("routerLink",t.DdM(3,tt)))},dependencies:[d.rH]})}return e})();const nt=function(){return["../payment"]};let ot=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-confirm-order"]],decls:2,vars:2,consts:[[3,"routerLink"]],template:function(o,r){1&o&&(t.TgZ(0,"a",0),t._uU(1,"back"),t.qZA()),2&o&&t.Q6J("routerLink",t.DdM(1,nt))},dependencies:[d.rH]})}return e})(),Z=(()=>{class e{constructor(n,o){this.authService=n,this.router=o}canActivate(n){return!!this.authService.isLogged()||(n&&this.router.navigate(["/ecommerce/checkout/choose-address"]),!1)}canMatch(){return!!this.authService.isLogged()}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(m.e),t.LFG(d.F0))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const w=(e,c)=>c.url.includes("/checkout/")?(0,t.f3M)(Z).canActivate(!0):(0,t.f3M)(Z).canActivate(),rt=[{path:"",component:U,children:[{path:"choose-address",component:K},{path:"payment",canActivate:[w],component:et},{path:"confirm-order",canActivate:[w],component:ot},{path:"",redirectTo:"choose-address",pathMatch:"full"}]}];let it=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(rt),d.Bz]})}return e})();var st=s(8031),at=s(6288);let ct=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[p.ez,it,st.m,_.q,T.U$,at.a]})}return e})()}}]);